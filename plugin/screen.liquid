{% comment %}
Mini Movie Marquee — Landscape layout for TRMNL OG (800×480, 4‑level e‑ink)
Poster maximized on the left, metadata + compact QR on the right.
Supports Polling (data.* or root) and Display API (payload.*).
{% endcomment %}

{% assign title = data.title %}
{% assign subtitle = data.subtitle %}
{% assign theatre = data.theatre %}
{% assign poster_url = data.poster_url %}
{% assign ticket_url = data.ticket_url %}
{% assign show_qr = data.show_qr | default: false %}

<style>
  :root {
    --bg: #ffffff;
    --text: #0f0f0f;
    --muted: #555555;
    --stroke: #cccccc;
  }

  body {
    margin: 0;
    padding: 0;
    font-family: "Inter", "Helvetica Neue", Arial, sans-serif;
    background: var(--bg);
    color: var(--text);
  }

  .screen {
    box-sizing: border-box;
    width: 800px;
    height: 480px;
    display: flex;
    flex-direction: row;
    padding: 0;      /* full-bleed: no outer padding */
    gap: 16px;       /* small internal gutter only */
    background: var(--bg);
  }

  /* Left: poster column — full available height, preserved aspect (2:3) */
  .poster {
    flex: 0 0 auto;
    height: 100%;
    aspect-ratio: 2 / 3;
    border-radius: 0;       /* full-bleed: no rounded edges */
    border: none;           /* full-bleed: no border */
    background: #e8e8e8;    /* placeholder bg behind poster */
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  }
  .poster img {
    width: 100%;
    height: 100%;
    object-fit: contain;   /* never crop tall portrait posters */
  }
  .poster--placeholder {
    font-size: 22px;
    font-weight: 600;
    text-transform: uppercase;
    text-align: center;
    color: var(--muted);
    padding: 16px;
  }

  /* Right: metadata column */
  .meta {
    flex: 1 1 0;
    display: flex;
    flex-direction: column;
    min-width: 0; /* allow text to wrap nicely */
    padding: 24px 24px 24px 0; /* add breathing room around text, keep left flush to gap */
  }
  .meta__theatre {
    text-transform: uppercase;
    letter-spacing: 0.12em;
    font-size: 15px;
    color: var(--muted);
    margin: 0 0 8px 0;
  }
  .meta__title {
    font-size: 44px;
    line-height: 1.05;
    margin: 0 0 14px 0;
    word-break: break-word;
    hyphens: auto;
  }
  .meta__subtitle {
    font-size: 26px;
    margin: 0 0 24px 0;
  }

  /* QR block anchored to the bottom of the right column */
  .qr {
    margin-top: auto;
    border-top: none;
    padding-top: 0;
    display: flex;
    align-items: center;
    gap: 14px;
  }
  .qr__code {
    width: 120px;     /* compact but reliable on 800×480 e‑ink */
    height: 120px;
    border: none;
    background: #fff; /* maintain quiet zone contrast */
    display: flex;
    align-items: center;
    justify-content: center;
  }
  .qr__caption {
    font-size: 18px;
    line-height: 1.3;
    max-width: 220px;
    color: var(--muted);
  }
  /* Image-based gray divider to survive e-ink quantization */
  .divider {
    width: 100%;
    height: 2px;
    display: block;
    margin: 12px 0 12px 0;
    object-fit: fill;
  }
</style>

<div class="screen">
  <div class="poster">
    {% if poster_url %}
      <img class="image" src="{{ poster_url }}" alt="{{ title | escape }} poster" />
    {% else %}
      <div class="poster--placeholder">Poster unavailable</div>
    {% endif %}
  </div>

  <div class="meta">
    <p class="meta__theatre">{{ theatre | default: "RevivalHub" }}</p>
    <h1 class="meta__title">{{ title | default: "Coming Soon" }}</h1>
    <p class="meta__subtitle">{{ subtitle | default: "Showtime TBD" }}</p>

    <!-- Gray divider rendered as an image so grayscale is preserved -->
    <img
      class="image divider"
      alt=""
      src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 2' width='100' height='2'><rect width='100' height='2' fill='%23999999'/></svg>"
    />

    {% if show_qr and ticket_url %}
      <div class="qr">
        <div class="qr__code">
          <img
            class="image"
            src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&amp;margin=2&amp;data={{ ticket_url | url_encode }}"
            alt="QR code for tickets"
            width="120"
            height="120"
          />
        </div>
        <p class="qr__caption">Scan to buy tickets or learn more.</p>
      </div>
    {% endif %}
  </div>
</div>

